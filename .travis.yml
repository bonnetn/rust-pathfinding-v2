language: rust
dist:
  - trusty
os:
- linux
- windows
arch:
- arm64
- amd64
rust:
- nightly
jobs:
  allow_failures:
  - rust: nightly
  fast_finish: true
cache: cargo
script:
- cargo build --verbose --all
- cargo test --verbose --all
- cargo build --release --verbose --all
before_deploy:
  - ls -la "target/release/libpathfinder_v2.so"
  - mv "target/release/libpathfinder_v2.so" "target/release/libpathfinder_v2-$TRAVIS_TAG-$TRAVIS_OS_NAME.so"
deploy:
  provider: releases
  token:
    secure: VDaHrd2hc37Tm96rFH+EKRaqMQTOahkwFjTkljDhUsUpTbDY8r2YhhViZBH5f5PIVuPPgE59EkFSrztQ2k+zWFsG6/9OdfNhlk2XJDnDT5z2C1rsEktcAKrgUG7pW+u/V5R47qEoBzwzK8Wrc01GNiSvWlxGYNeJaLU6iVv4V44M5h4ufv0+r1V3dKjIPADbP9bBsYdaD5gD1aBd6k8MKDeGLRWCBfCp2I3yWxD8JOJHZSByVT92gbprTj4NBY3TgY++SOIigtjN8cHkpPdHMAbcvA0+u7KFnAHCB7Yyp56GOHakDLk5IT1YGCcOIkVtX9jhvvxyuMtlu0HYiCUhkM/No+N+pPiMNkNZYa00LHHWgPdKLhNsZXd8yorbbWK9HDXWdhvaN6Y147TmL60c4gL3nhNNAwyTdxX+AckDj6v1ANzixo45w0OIGlHWkiO+87Gf57LEKlgO9R0GHbpeOBFHW8WWBsWIUXjqSwdrS5z1zNlI+bCdPs56YBDHgAMGcGpQX5F9okSvc5KfvilxKDu0ntsCr6AYv32dDrM1rubpTHq1rY0AtMTxBB6MNZNY1DixkikxVaJ9a4BrXbD1i4SbUDt+fpGCPgjz2hKTPqXWztR4y7UaupSnIX5OvW1wZli/5gj4oV8HA9N255i5XUbtQRS8Hq6XOqokHK59ru8=
  file: target/release/libpathfinder_v2.*
  on:
    repo: bonnetn/rust-pathfinding-v2
  cleanup: 'false'
